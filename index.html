<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nusantara AI v5.9</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background: #0e0e12;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 20px;
      overflow-x: hidden;
    }
    .logo {
      position: absolute;
      top: 20px;
      left: 20px;
      font-size: 18px;
      font-weight: bold;
      color: #ffffff;
      z-index: 10;
    }
    .container {
      max-width: 600px;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 60px;
    }
    .avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: linear-gradient(135deg, #fffacd 0%, #ffd1dc 25%, #e6e6fa 50%, #d0f0f8 100%);
      margin-bottom: 20px;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
      animation: pulse 3s ease-in-out infinite;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    h1 {
      font-size: 22px;
      margin-bottom: 5px;
      font-weight: 500;
      letter-spacing: 0.5px;
    }
    .subtitle {
      color: #aaa;
      font-size: 13px;
      margin-bottom: 20px;
    }
    .chat-history {
      width: 100%;
      max-height: 400px;
      overflow-y: auto;
      padding: 10px;
      margin-bottom: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .message {
      padding: 12px 16px;
      border-radius: 16px;
      max-width: 80%;
      word-wrap: break-word;
      line-height: 1.4;
    }
    .user-message {
      background: rgba(255, 255, 255, 0.1);
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }
    .ai-message {
      background: linear-gradient(135deg, #2b2b3a 0%, #3a3a4f 100%);
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }
    .chat-input-container {
      position: relative;
      width: 100%;
      max-width: 500px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .input-addon {
      background: rgba(255, 255, 255, 0.05);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    .input-addon:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    .input-addon svg {
      fill: white;
      width: 18px;
      height: 18px;
    }
    .chat-input {
      flex: 1;
      padding: 15px 20px;
      border-radius: 50px;
      border: none;
      background: rgba(255, 255, 255, 0.05);
      color: white;
      font-size: 16px;
      outline: none;
      transition: background 0.3s;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .chat-input::placeholder {
      color: #aaa;
    }
    .send-btn {
      background: linear-gradient(135deg, #fffacd 0%, #ffd1dc 25%, #e6e6fa 50%, #d0f0f8 100%);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    }
    .send-btn:hover {
      transform: scale(1.1);
    }
    .send-btn svg {
      fill: #0e0e12;
      width: 16px;
      height: 16px;
    }
    .quick-actions {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    .quick-action-btn {
      background: rgba(255, 255, 255, 0.05);
      border: none;
      border-radius: 20px;
      padding: 8px 15px;
      color: #ccc;
      font-size: 12px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .quick-action-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    #fileInput {
      display: none;
    }
    @media (max-width: 600px) {
      .avatar { width: 80px; height: 80px; }
      h1 { font-size: 20px; }
      .chat-input { padding: 12px 15px; font-size: 14px; }
      .input-addon, .send-btn { width: 36px; height: 36px; }
      .message { max-width: 85%; }
    }
  </style>
</head>
<body>
  <div class="logo">Nusantara AI v5.9</div>
  <div class="container">
    <div class="avatar"></div>
    <h1>Ask me anything</h1>
    <p class="subtitle">Upload file or ask about culture, agriculture, trade, history, and more!</p>
    <div class="chat-history" id="chatHistory"></div>
    <div class="chat-input-container">
      <button class="input-addon" id="addImageBtn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
      </button>
      <input type="text" class="chat-input" placeholder="Type your question or upload a file..." id="userInput" />
      <button class="send-btn" id="sendBtn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M8 5v14l11-7z"/>
        </svg>
      </button>
    </div>
    <div class="quick-actions">
      <button class="quick-action-btn">Upload Image</button>
      <button class="quick-action-btn">Search Image</button>
      <button class="quick-action-btn">Cultural Mode</button>
    </div>
  </div>

  <input type="file" id="fileInput" accept=".txt,image/*" />

  <script>
    // =============== KNOWLEDGE BASE LENGKAP ===============
    const knowledgeBase = {
      // ========== SEKTOR PERTANIAN (DATA BARU) ==========
      sektorPertanian: {
        keywords: ['pertanian', 'sektor pertanian', 'lahan pertanian', 'petani', 'pangan', 'pupuk', 'irigasi', 'panen', 'sawah', 'perkebunan', 'pertanian modern', 'ketahanan pangan'],
        pengertian: "Sektor pertanian adalah bagian dari perekonomian yang bergerak dalam budidaya tanaman, peternakan, perikanan, kehutanan, dan agroindustri untuk menghasilkan bahan pangan, bahan baku industri, dan komoditas ekspor.",
        subsektor: [
          "Tanaman Pangan (padi, jagung, kedelai)",
          "Hortikultura (sayur, buah, bunga)",
          "Perkebunan (kelapa sawit, karet, kopi, cokelat)",
          "Peternakan (sapi, ayam, kambing)",
          "Perikanan (budidaya & tangkap)",
          "Kehutanan"
        ],
        peranPenting: [
          "Menyediakan pangan bagi seluruh rakyat",
          "Menyerap tenaga kerja (±30% angkatan kerja Indonesia)",
          "Sumber devisa ekspor (CPO, kopi, karet)",
          "Menjaga keseimbangan ekosistem"
        ],
        tantangan: [
          "Alih fungsi lahan pertanian ke non-pertanian",
          "Ketergantungan pada cuaca & iklim",
          "Akses terbatas ke teknologi & modal",
          "Fluktuasi harga komoditas",
          "Dampak perubahan iklim"
        ],
        inovasiModern: [
          "Pertanian presisi (drones, sensor tanah)",
          "Sistem irigasi tetes (drip irrigation)",
          "Pupuk organik & biopestisida",
          "Varietas unggul tahan hama & kekeringan",
          "Digital farming (aplikasi manajemen lahan)"
        ],
        kebijakanPemerintah: {
          cetakSawah: "Program perluasan lahan sawah baru",
          pupukSubsidi: "Pupuk urea & NPK untuk petani",
          asuransiUsahaTani: "Proteksi terhadap gagal panen",
          foodEstate: "Kawasan pangan terpadu skala besar"
        },
        contohKomoditasEkspor: [
          "Minyak sawit mentah (CPO)",
          "Kopi Arabika & Robusta",
          "Karet alam",
          "Lada, cengkeh, pala"
        ],
        ketahananPangan: "Kemampuan negara menyediakan pangan cukup, aman, bergizi, dan terjangkau bagi seluruh rakyat sepanjang waktu."
      },

      // ========== PERDAGANGAN DUNIA (DATA BARU) ==========
      perdaganganDunia: {
        keywords: ['perdagangan dunia', 'ekspor', 'impor', 'globalisasi ekonomi', 'konsumen', 'produsen', 'perdagangan internasional', 'barter', 'nilai tukar', 'trade', 'world trade', 'WTO', 'ASEAN', 'perjanjian dagang'],
        pengertian: "Perdagangan dunia adalah kegiatan pertukaran barang dan jasa antarnegara yang dilakukan secara transnasional, melibatkan ekspor (penjualan ke luar negeri) dan impor (pembelian dari luar negeri), dengan tujuan memperoleh keuntungan, memenuhi kebutuhan dalam negeri, dan memperluas akses pasar.",
        eksporImpor: {
          ekspor: "Pengiriman barang/jasa dari dalam negeri ke luar negeri. Contoh: Indonesia mengekspor CPO (Crude Palm Oil), batubara, dan kopi.",
          impor: "Pembelian barang/jasa dari luar negeri ke dalam negeri. Contoh: Indonesia mengimpor mesin industri, minyak mentah, dan smartphone."
        },
        peranKonsumenDanProdusen: {
          pengertian: "Produsen menciptakan barang/jasa, sedangkan konsumen menggunakan/membeli produk tersebut. Dalam perdagangan dunia, keduanya terhubung melalui:",
          saluran: [
            "Perdagangan langsung (direct trade)",
            "E-commerce global (Shopee Global, Amazon, Alibaba)",
            "Distributor internasional",
            "Perjanjian dagang bilateral/multilateral",
            "Organisasi perdagangan seperti WTO (World Trade Organization)"
          ]
        },
        faktorPendorong: [
          "Perbedaan sumber daya alam",
          "Perbedaan teknologi & efisiensi produksi",
          "Permintaan global",
          "Kebijakan pemerintah (tarif, kuota, subsidi)",
          "Globalisasi dan kemajuan transportasi/komunikasi"
        ],
        hambatanPerdagangan: [
          "Tarif (pajak impor)",
          "Kuota (batas jumlah barang yang boleh masuk)",
          "Embargo (larangan dagang politik)",
          "Standar teknis & regulasi (SNI, CE, FDA)",
          "Biaya logistik & jarak"
        ],
        organisasiPerdagangan: {
          WTO: "World Trade Organization – mengawasi aturan perdagangan global dan menyelesaikan sengketa antarnegara.",
          ASEAN: "Perdagangan bebas antarnegara Asia Tenggara melalui AFTA (ASEAN Free Trade Area).",
          APEC: "Forum kerja sama ekonomi Asia-Pasifik.",
          G20: "Forum negara maju & berkembang membahas kebijakan ekonomi global."
        },
        dampakPositif: [
          "Meningkatkan pertumbuhan ekonomi",
          "Mendorong inovasi & efisiensi",
          "Memperluas pilihan konsumen",
          "Menciptakan lapangan kerja",
          "Transfer teknologi"
        ],
        dampakNegatif: [
          "Ketergantungan pada negara lain",
          "Industri lokal bisa mati jika tidak kompetitif",
          "Eksploitasi sumber daya alam",
          "Ketimpangan perdagangan (negara berkembang sering jadi pengekspor bahan mentah)"
        ],
        contohNyata: {
          indonesia: "Ekspor utama: minyak sawit, batubara, nikel. Impor utama: mesin, elektronik, bahan baku industri.",
          china: "Pabrik dunia – ekspor barang manufaktur ke seluruh dunia.",
          jerman: "Ekspor mobil, mesin, dan obat-obatan berkualitas tinggi."
        },
        istilahPenting: {
          neracaPerdagangan: "Selisih antara nilai ekspor dan impor. Surplus jika ekspor > impor; defisit jika sebaliknya.",
          devisa: "Mata uang asing yang diperoleh dari ekspor, digunakan untuk impor atau cadangan negara.",
          perdaganganBebas: "Sistem tanpa hambatan tarif atau kuota (contoh: dalam kawasan ASEAN)."
        }
      },

      // ========== DATA LAMA YANG LENGKAP ==========
      budaya: {
        keywords: ['budaya', 'adat', 'tradisi', 'kesenian', 'tari', 'rumah adat', 'makanan khas', 'seni', 'nusantara'],
        pengertian: "Budaya Nusantara adalah keseluruhan cara hidup masyarakat Indonesia yang mencakup nilai, norma, seni, adat istiadat, dan kepercayaan.",
        tari: ["Tari Saman (Aceh)", "Tari Pendet (Bali)", "Tari Reog Ponorogo (Jawa Timur)", "Tari Tor-Tor (Batak)"],
        rumahAdat: ["Rumah Gadang (Minangkabau)", "Joglo (Jawa)", "Tongkonan (Toraja)", "Honai (Papua)"],
        makanan: ["Rendang (Sumatra Barat)", "Gudeg (Yogyakarta)", "Papeda (Maluku/Papua)", "Soto Banjar (Kalimangan Selatan)"]
      },
      nkri: {
        keywords: ['nkri', 'negara kesatuan', 'indonesia', 'pemerintahan pusat', 'jakarta', 'bentuk negara'],
        pengertian: "Negara Kesatuan Republik Indonesia (NKRI) adalah bentuk negara Indonesia yang bersatu dengan satu pemerintahan pusat.",
        manfaat: ["Menjaga persatuan", "Memudahkan koordinasi pemerintahan", "Memperkuat identitas nasional"],
        contoh: "Semua provinsi di Indonesia berada di bawah satu pemerintahan pusat di Jakarta."
      },
      bhinnekaTunggalIka: {
        keywords: ['bhinneka', 'bhinneka tunggal ika', 'berbeda tetap satu', 'toleransi', 'keberagaman', 'semboyan', 'indonesia'],
        pengertian: "Bhinneka Tunggal Ika berarti 'Berbeda-beda tetapi tetap satu', semboyan resmi Indonesia yang mencerminkan persatuan dalam keberagaman.",
        nilaiPancasila: "Sila ke-2 (Kemanusiaan yang Adil dan Beradab) dan Sila ke-3 (Persatuan Indonesia).",
        manfaat: ["Memperkuat toleransi", "Mencegah konflik SARA", "Membangun kebersamaan"],
        contoh: "Perayaan hari besar agama bersama tanpa membedakan suku dan agama."
      },
      pancasila: {
        keywords: ['pancasila', 'sila', 'dasar negara', 'ideologi', 'lima sila', 'falsafah'],
        pengertian: "Pancasila adalah dasar negara dan ideologi bangsa Indonesia yang terdiri dari lima sila sebagai pedoman kehidupan berbangsa dan bernegara.",
        sila1: "Ketuhanan Yang Maha Esa",
        sila2: "Kemanusiaan yang Adil dan Beradab",
        sila3: "Persatuan Indonesia",
        sila4: "Kerakyatan yang Dipimpin oleh Hikmat Kebijaksanaan dalam Permusyawaratan/Perwakilan",
        sila5: "Keadilan Sosial bagi Seluruh Rakyat Indonesia"
      },
      hikayat: {
        keywords: ['hikayat', 'cerita lama', 'prosa lama', 'sastra melayu klasik'],
        pengertian: "Hikayat adalah karya sastra prosa lama Melayu yang menceritakan kehidupan tokoh bangsawan, pahlawan, atau raja-raja di masa lampau.",
        tujuan: "Menghibur, menyampaikan nilai moral, melestarikan sejarah, dan menanamkan ajaran agama/etika.",
        struktur: "1. Pembukaan (doa/salawat), 2. Isi (alur cerita), 3. Penutup (nasihat/moral).",
        kaidahKebahasaan: "Menggunakan bahasa Melayu klasik, kata arkais (kuno), kalimat pasif, repetisi, metafora, dan hiperbola.",
        contoh: "Hikayat Hang Tuah, Hikayat Si Miskin, Hikayat Abdullah, Hikayat Bayan Budiman."
      },
      laporanHasilObservasi: {
        keywords: ['laporan hasil observasi', 'teks observasi', 'pengamatan', 'objek', 'deskripsi', 'observasi', 'struktur teks observasi', 'kaidah kebahasaan observasi'],
        pengertianObservasi: "Observasi adalah kegiatan mengamati suatu objek, peristiwa, atau gejala secara sistematis, terencana, dan objektif untuk mengumpulkan data faktual.",
        pengertianTeks: "Teks laporan hasil observasi adalah teks yang berisi informasi faktual hasil pengamatan sistematis terhadap suatu objek atau fenomena alam.",
        tujuan: "Memberikan informasi objektif berdasarkan fakta pengamatan tanpa opini pribadi.",
        struktur: {
          "Pernyataan Umum (Definisi/Klasifikasi)": "Memperkenalkan objek secara umum: apa itu, ciri umum, klasifikasi ilmiah (jika ada).",
          "Deskripsi Bagian": "Menggambarkan ciri-ciri objek secara rinci: bentuk, ukuran, warna, perilaku, habitat, fungsi, dll."
        },
        kaidahKebahasaan: {
          "Kata Benda (Nomina)": "Menggunakan istilah teknis atau ilmiah (misal: fotosintesis, metamorfosis, habitat).",
          "Kata Kerja Material": "Kata kerja yang menunjukkan tindakan nyata (misal: mengamati, mencatat, bergerak, tumbuh, berkembang).",
          "Kalimat Definisi": "Menggunakan pola 'A adalah B' atau 'A merupakan B' (misal: Kupu-kupu adalah serangga yang mengalami metamorfosis sempurna).",
          "Kata Sifat (Adjektiva)": "Menggambarkan ciri objek (misal: berwarna cerah, berukuran kecil, bergerak cepat).",
          "Kalimat Pernyataan Faktual": "Bersifat objektif, tidak menggunakan kata-kata subjektif seperti 'menurut saya', 'indah', 'jelek'.",
          "Penggunaan Istilah Ilmiah": "Contoh: vertebrata, invertebrata, herbivora, karnivora, autotrof."
        },
        contoh: "Laporan pengamatan kupu-kupu: siklus hidup (telur → larva → pupa → imago), warna sayap, habitat (taman, hutan), cara makan (menghisap nektar), dan peran dalam penyerbukan."
      },
      narrativeText: {
        keywords: ['narrative text', 'cerita naratif', 'english story', 'orientation complication resolution'],
        pengertian: "Narrative text is a genre of writing that tells a story about past events to entertain readers.",
        orientation: "Introduces characters, setting, and time. Example: 'Once upon a time, there lived a kind princess in a castle.'",
        complication: "The main problem or conflict arises. Example: 'One day, an evil witch cursed the princess to sleep forever.'",
        resolution: "The problem is solved. Example: 'A brave prince kissed her, and the curse was broken.'",
        ciriKebahasaanInggris: "Uses past tense, action verbs, time connectives (once, then, finally), and direct/indirect speech.",
        contoh: "Cinderella, Snow White, The Legend of Malin Kundang (adapted)."
      },
      teknologi: {
        keywords: ['teknologi', 'perangkat keras', 'hardware', 'perangkat lunak', 'software', 'aplikasi', 'gadget', 'komputer', 'hp'],
        pengertian: "Menurut KBBI, teknologi adalah metode ilmiah untuk mencapai tujuan praktis; ilmu pengetahuan terapan yang digunakan untuk memudahkan interaksi dan aktivitas manusia, termasuk dalam bermedia sosial.",
        perangkatKeras: ["Handphone (HP)", "Komputer", "Laptop", "Tablet", "Server", "Printer", "Router"],
        perangkatLunak: ["Aplikasi berhitung (kalkulator)", "Aplikasi pembayaran (GoPay, OVO, DANA)", "Sistem operasi (Windows, Android, iOS)", "Browser (Chrome, Firefox)", "Aplikasi media sosial (Instagram, WhatsApp, TikTok)"],
        manfaat: ["Mempermudah komunikasi", "Mempercepat akses informasi", "Meningkatkan efisiensi kerja", "Mendukung pembelajaran jarak jauh"]
      },
      majas: {
        keywords: ['majas', 'gaya bahasa', 'personifikasi', 'metafora', 'ironi', 'hiperbola'],
        pengertian: "Majas atau gaya bahasa adalah penggunaan kata-kata secara kiasan untuk menciptakan efek tertentu dalam karya sastra.",
        personifikasi: {
          pengertian: "Memberikan sifat manusia pada benda mati atau konsep abstrak.",
          contoh: "Angin berbisik pelan di telingaku."
        },
        metafora: {
          pengertian: "Perbandingan langsung tanpa kata pembanding (seperti, bagai).",
          contoh: "Dunia adalah panggung sandiwara."
        },
        ironi: {
          pengertian: "Mengatakan sesuatu yang bertentangan dengan maksud sebenarnya untuk menyindir.",
          contoh: "Wah, hebat sekali kamu sampai lupa ulang tahun ibumu!"
        },
        hiperbola: {
          pengertian: "Pengungkapan berlebihan untuk menekankan sesuatu.",
          contoh: "Aku sudah menunggumu berabad-abad!"
        }
      },
      keuangan: {
        keywords: ['keuangan', 'bank', 'non bank', 'lembaga keuangan', 'akuntansi', 'laporan keuangan', 'uang', 'investasi'],
        pengertian: "Keuangan adalah segala aktivitas yang berkaitan dengan pengelolaan uang, termasuk investasi, pinjaman, dan penganggaran.",
        perbankan: {
          pengertian: "Lembaga keuangan yang menghimpun dana dari masyarakat (simpanan) dan menyalurkannya kembali (kredit).",
          jenis: ["Bank Umum (BCA, BRI, Mandiri)", "Bank Perkreditan Rakyat (BPR)"],
          fungsi: ["Menciptakan uang giral", "Menyalurkan kredit", "Menyediakan jasa lalu lintas pembayaran"]
        },
        nonBank: {
          pengertian: "Lembaga keuangan yang tidak menghimpun dana dalam bentuk simpanan.",
          contoh: ["OJK", "Asuransi (Jiwasraya, Prudential)", "Dana Pensiun", "Perusahaan Efek", "Fintech (Pinjaman online)"]
        },
        akuntansi: {
          pengertian: "Proses pencatatan, penggolongan, peringkasan, dan pelaporan transaksi keuangan.",
          laporanKeuangan: ["Neraca", "Laporan Laba Rugi", "Arus Kas", "Perubahan Ekuitas"],
          prinsip: ["Relevansi", "Keandalan", "Konsistensi", "Daya Banding"]
        },
        istilahKeuangan: {
          likuiditas: "Kemampuan perusahaan membayar kewajiban jangka pendek.",
          solvabilitas: "Kemampuan membayar seluruh kewajiban (jangka panjang & pendek).",
          ROI: "Return on Investment — ukuran keuntungan relatif terhadap investasi.",
          inflasi: "Kenaikan harga barang/jasa secara umum dalam periode tertentu."
        }
      },
      englishTenses: {
        keywords: ['present tense', 'past tense', 'simple present', 'simple past', 'rumus present', 'rumus past', 'tenses inggris', 'regular verb', 'irregular verb', 'kata kerja'],
        pengertian: "Tenses adalah bentuk kata kerja (verb) yang menunjukkan waktu terjadinya suatu peristiwa: masa kini (present), lampau (past), atau akan datang (future).",
        presentTense: {
          pengertian: "Digunakan untuk kebiasaan, fakta umum, atau kejadian rutin.",
          rumus: {
            positif: "S + V1 (s/es) + O/C\nContoh: She plays violin every day.",
            negatif: "S + do/does + not + V1 + O/C\nContoh: They do not like spicy food.",
            tanya: "Do/Does + S + V1 + O/C?\nContoh: Do you study English?"
          },
          catatan: "Tambahkan -s/-es pada verb jika subjek: he, she, it."
        },
        pastTense: {
          pengertian: "Digunakan untuk kejadian yang sudah selesai di masa lampau.",
          rumus: {
            positif: "S + V2 + O/C\nContoh: I watched a movie yesterday.",
            negatif: "S + did + not + V1 + O/C\nContoh: She did not go to school.",
            tanya: "Did + S + V1 + O/C?\nContoh: Did they visit Bali last year?"
          }
        },
        regularVerbs: {
          pengertian: "Kata kerja beraturan: bentuk kedua & ketiga dibuat dengan menambahkan -ed.",
          contoh: [
            "play – played – played",
            "watch – watched – watched",
            "clean – cleaned – cleaned",
            "study – studied – studied"
          ]
        },
        irregularVerbs: {
          pengertian: "Kata kerja tidak beraturan: bentuk kedua & ketiga tidak mengikuti pola -ed.",
          contohLengkap: [
            "go – went – gone",
            "eat – ate – eaten",
            "see – saw – seen",
            "take – took – taken",
            "write – wrote – written",
            "sing – sang – sung",
            "drink – drank – drunk",
            "break – broke – broken",
            "do – did – done",
            "have – had – had"
          ]
        }
      },
      narrativeStructure: {
        keywords: ['struktur narrative text', 'orientation complication resolution', 'evaluation coda', 'bagian cerita naratif', 'coda', 'evaluation'],
        pengertian: "Struktur teks naratif terdiri dari lima bagian utama yang membentuk alur cerita yang utuh.",
        orientation: "Memperkenalkan tokoh, latar (tempat & waktu), dan suasana awal.\nContoh: Once upon a time, there was a kind girl named Cinderella.",
        complication: "Munculnya konflik atau masalah dalam cerita.\nContoh: Her stepmother forbade her from attending the royal ball.",
        resolution: "Pemecahan masalah atau penyelesaian konflik.\nContoh: With the help of her fairy godmother, she went to the ball and met the prince.",
        evaluation: "Penilaian terhadap peristiwa atau pelajaran moral (opsional, sering menyatu dengan resolution).",
        coda: "Kesimpulan atau akhir cerita yang menunjukkan perubahan kondisi tokoh.\nContoh: They lived happily ever after."
      },
      tabelPeriodik: {
        keywords: ['tabel periodik', 'unsur kimia', 'simbol unsur', 'unsur', 'campuran kimia', 'rumus kimia', 'H2O', 'NaCl', 'CO2'],
        pengertian: "Tabel periodik adalah susunan unsur-unsur kimia yang diatur berdasarkan kenaikan nomor atom dan kemiripan sifat kimianya.",
        simbolUnsur: "Setiap unsur memiliki simbol unik, contoh: H (Hidrogen), O (Oksigen), Fe (Besi), Na (Natrium), Cl (Klorin).",
        campuranUmum: [
          "Air (H₂O) — gabungan hidrogen dan oksigen",
          "Garam dapur (NaCl) — natrium + klorin",
          "Karbon dioksida (CO₂) — karbon + oksigen",
          "Amonia (NH₃) — nitrogen + hidrogen"
        ],
        manfaat: [
          "Memprediksi sifat dan reaktivitas unsur",
          "Dasar pengembangan obat dan material baru",
          "Digunakan di industri logam, energi, dan pertanian",
          "Alat pembelajaran wajib di sekolah"
        ],
        contohUnsur: [
          "Oksigen (O₂) — untuk bernapas",
          "Besi (Fe) — bahan bangunan dan kendaraan",
          "Tembaga (Cu) — kabel listrik",
          "Karbon (C) — dasar kehidupan dan bahan bakar"
        ]
      },
      perubahanZatDanLingkungan: {
        keywords: ['perubahan fisika', 'perubahan kimia', 'biotik', 'abiotik', 'wujud zat', 'mengembun', 'menyublim', 'menguap', 'membeku', 'mencair', 'deposisi', 'perubahan iklim', 'karbon dioksida'],
        biotikAbiotik: {
          biotik: "Benda hidup yang bisa tumbuh, berkembang biak, dan mati.\nContoh: manusia, hewan, tumbuhan, bakteri.",
          abiotik: "Benda mati yang tidak memiliki ciri makhluk hidup.\nContoh: batu, air, udara, kayu (setelah ditebang), tanah."
        },
        perubahanFisika: {
          pengertian: "Perubahan bentuk atau wujud tanpa menghasilkan zat baru (reversibel).",
          contoh: "Es mencair → air → dibekukan lagi jadi es.",
          ciri: "Tidak ada zat baru, hanya berubah wujud."
        },
        perubahanKimia: {
          pengertian: "Perubahan yang menghasilkan zat baru (ireversibel).",
          contoh: "Kayu dibakar → jadi arang dan asap, susu basi, besi berkarat.",
          ciri: "Terbentuk zat baru, tidak bisa dikembalikan."
        },
        perubahanWujud: {
          mencair: "Padat → cair (es → air)",
          membeku: "Cair → padat (air → es)",
          menguap: "Cair → gas (air → uap)",
          mengembun: "Gas → cair (uap → air)",
          menyublim: "Padat → gas (kapur barus menguap)",
          deposisi: "Gas → padat (uap air → salju)"
        },
        perubahanIklim: {
          pengertian: "Perubahan jangka panjang pola cuaca akibat pemanasan global.",
          penyebab: "Emisi gas rumah kaca (CO₂, metana) dari kendaraan, pabrik, dan deforestasi.",
          dampak: "Es kutub mencair → permukaan laut naik → banjir di wilayah pesisir.",
          solusi: "Gunakan energi terbarukan, tanam pohon, kurangi sampah plastik."
        }
      },
      norma: {
        keywords: ['norma', 'aturan', 'sosial', 'kesopanan', 'agama', 'hukum', 'kebiasaan', 'norma sekolah', 'norma keluarga'],
        pengertian: "Norma adalah aturan atau pedoman yang mengatur perilaku dalam masyarakat.",
        jenis: ["Norma agama", "Norma hukum", "Norma kesopanan", "Norma kebiasaan"],
        contohSehariHari: [
          "Tidak boleh mencuri (norma hukum & agama)",
          "Antri saat beli makanan (norma kesopanan)",
          "Pakai seragam sekolah (norma sekolah)",
          "Bantu orang tua di rumah (norma keluarga)"
        ],
        tempatBerlaku: "Berlaku di rumah, sekolah, tempat ibadah, masyarakat umum, dan negara"
      },
      analisisCerita: {
        keywords: ['latar tempat', 'latar waktu', 'latar suasana', 'tema', 'tokoh', 'penokohan', 'abstraksi', 'orientasi', 'komplikasi', 'evaluasi', 'resolusi', 'koda', 'unsur intrinsik'],
        latarTempat: "Lokasi terjadinya cerita (misal: sekolah, hutan, kota, istana).",
        latarWaktu: "Waktu kejadian cerita (pagi, siang, malam, zaman dahulu, masa depan).",
        latarSuasana: "Suasana emosional dalam cerita (sedih, tegang, bahagia, mencekam, haru).",
        tema: "Gagasan pokok atau pesan utama yang muncul di seluruh cerita (misal: cinta, pengorbanan, keadilan).",
        tokoh: "Pelaku atau karakter dalam cerita (tokoh utama, tokoh antagonis, tokoh pendukung).",
        penokohan: "Cara pengarang menggambarkan sifat tokoh (langsung: 'Si Fulan jujur', tidak langsung: lewat dialog/perilaku).",
        abstraksi: "Gambaran umum atau ringkasan awal cerita (sering muncul di teks eksposisi atau naratif modern).",
        orientasi: "Bagian awal cerita yang memperkenalkan tokoh, latar, dan suasana.",
        komplikasi: "Rangkaian peristiwa yang memunculkan konflik atau masalah.",
        evaluasi: "Penilaian terhadap perkembangan peristiwa atau konflik (opsional, sering menyatu dengan resolusi).",
        resolusi: "Penyelesaian dari konflik atau masalah dalam cerita.",
        koda: "Amanat, pesan moral, atau kesimpulan di akhir cerita (misal: 'Jadilah jujur dalam segala hal.')."
      },
      adjective: {
        keywords: ['adjective', 'adjective bahasa indonesia'],
        pengertian: "Adjective (kata sifat) adalah kata yang memberi keterangan pada kata benda (noun) atau pronoun untuk menjelaskan kualitas, ukuran, warna, dsb.",
        contoh: ["beautiful (cantik)", "big (besar)", "ancient (kuno)", "famous (terkenal)"],
        fungsi: "Menjelaskan sifat atau keadaan benda: quality (good), size (small), age (old), color (red), origin (Indonesian).",
        posisi: "Dalam Bahasa Inggris, adjective umumnya sebelum noun: 'a red car', sedangkan dalam Bahasa Indonesia biasanya setelah noun atau sebelum tergantung struktur: 'rumah besar' atau 'besar rumah' (umum: 'rumah besar')."
      },
      adverb: {
        keywords: ['adverb', 'adverb manner', 'adverb frequency', 'adverb time', 'adverb place'],
        pengertian: "Adverb (kata keterangan) memberi keterangan pada verb, adjective, atau adverb lainnya. Terdapat beberapa tipe: manner, frequency, time, place.",
        manner: {
          pengertian: "Adverb of manner menjelaskan bagaimana suatu tindakan dilakukan.",
          contoh: ["quickly (dengan cepat)", "slowly (dengan pelan)", "carefully (dengan hati-hati)"],
          contohKalimat: ["She sings beautifully. — Dia bernyanyi dengan indah.", "He writes neatly."]
        },
        frequency: {
          pengertian: "Adverb of frequency menunjukkan seberapa sering suatu kejadian terjadi.",
          contoh: ["always (selalu)", "often (sering)", "sometimes (kadang-kadang)", "never (tidak pernah)"],
          contohKalimat: ["I always brush my teeth in the morning."]
        },
        time: {
          pengertian: "Adverb of time menunjukkan kapan sesuatu terjadi.",
          contoh: ["yesterday (kemarin)", "today (hari ini)", "tomorrow (besok)", "now (sekarang)"],
          contohKalimat: ["They arrived yesterday."]
        },
        place: {
          pengertian: "Adverb of place menunjukkan lokasi/arah.",
          contoh: ["here (di sini)", "there (di sana)", "everywhere (di mana-mana)"],
          contohKalimat: ["Put it there, please."]
        }
      },
      imperative: {
        keywords: ['imperative'],
        pengertian: "Kalimat imperative memberi perintah, instruksi, atau ajakan. Biasanya subjek (you) dihilangkan dalam bentuk positif.",
        contoh: ["Please sit down. — Tolong duduk.", "Don't touch that! — Jangan sentuh itu!"],
        bentuk: {
          positif: "Verb dasar + objek (opsional). Contoh: 'Close the door.'",
          negatif: "Do not (don't) + verb. Contoh: 'Don't run in the hall.'",
          sopan: "Gunakan 'please' atau 'could you' untuk lebih sopan. Contoh: 'Please pass the salt.'"
        },
        catatan: "Imperative juga dipakai untuk memberi instruksi pada resep, petunjuk laboratorium, tanda, atau aturan sekolah."
      },
      descriptiveText: {
        keywords: ['descriptive text', 'teks deskripsi'],
        pengertian: "Descriptive text adalah teks yang menggambarkan karakteristik suatu objek, tempat, atau orang dengan rinci.",
        struktur: ["Identification (identifikasi objek)", "Description (deskripsi bagian dan sifat)"],
        kaidahBahasa: ["Kata sifat (adjectives)", "Adverb untuk keterangan tambahan", "Klausa deskriptif"],
        contohPendek: "My grandmother's house is old and charming. It has wooden floors and a garden full of fragrant flowers.",
        contohPanjang: "The Borobudur Temple is an ancient Buddhist monument located on a hill. The stone reliefs are intricate and the structure gives a feeling of grandeur."
      },
      recountText: {
        keywords: ['recount text'],
        pengertian: "Recount text adalah teks yang menceritakan kembali peristiwa masa lalu secara kronologis untuk memberi informasi atau rekaman pengalaman.",
        tujuan: "Untuk menceritakan apa yang terjadi di masa lampau (personal experience, news report, historical events).",
        struktur: ["Orientation (setting and participants)", "Events (sequence of events)", "Re-orientation or personal comment (opsional)"],
        contohPendek: "Yesterday, I visited my uncle. We had lunch and then went for a walk in the park.",
        contohPanjang: "Last summer, our family went to Yogyakarta. First, we visited Prambanan; then we tried batik-making. On the last day, we enjoyed Gudeg before heading home."
      },
      hukum: {
        keywords: ['hukum', 'peraturan', 'undang-undang', 'hak dan kewajiban', 'keadilan'],
        pengertian: "Hukum adalah sistem aturan yang mengatur tingkah laku anggota masyarakat, diciptakan oleh lembaga berwenang, dan memiliki sanksi bagi pelanggar.",
        jenis: ["Hukum pidana", "Hukum perdata", "Hukum tata negara", "Hukum administrasi negara"],
        prinsip: ["Kepastian hukum", "Keadilan", "Kemanfaatan"],
        contohHukum: "Tidak boleh mencuri (KUHP Pasal 362), wajib membayar pajak (UU Perpajakan)."
      },
      uud1945: {
        keywords: ['uud 1945', 'undang-undang dasar', 'konstitusi', 'pembukaan uud', 'pasal uud'],
        pengertian: "UUD 1945 adalah konstitusi atau dasar hukum tertinggi di Indonesia yang ditetapkan pada 18 Agustus 1945.",
        struktur: [
          "Pembukaan (4 alinea)",
          "Batang tubuh (16 bab, 37 pasal + aturan peralihan & tambahan)"
        ],
        pokokPikiran: [
          "Negara melindungi segenap bangsa",
          "Keadilan sosial bagi seluruh rakyat",
          "Kedaulatan berada di tangan rakyat",
          "Negara berdasar atas Ketuhanan YME"
        ],
        perubahan: "Diamandemen 4 kali (1999–2002) untuk demokratisasi dan HAM."
      },
      seni: {
        keywords: ['seni', 'karya seni', 'seni rupa', 'seni pertunjukan', 'estetika'],
        pengertian: "Seni adalah ekspresi perasaan, ide, atau nilai budaya melalui media visual, suara, gerak, atau kata yang memiliki nilai estetika.",
        jenis: [
          "Seni rupa (lukisan, patung, grafis)",
          "Seni pertunjukan (tari, teater, musik)",
          "Seni sastra (puisi, cerpen, novel)"
        ],
        fungsi: ["Ekspresi diri", "Hiburan", "Pendidikan", "Ritual/agama"],
        contohIndonesia: ["Lukisan Raden Saleh", "Tari Kecak", "Wayang Kulit"]
      },
      kbbi: {
        keywords: ['kbbi', 'kamus besar bahasa indonesia', 'kamus', 'bahasa indonesia', 'definisi'],
        pengertian: "KBBI (Kamus Besar Bahasa Indonesia) adalah kamus resmi Bahasa Indonesia yang diterbitkan oleh Badan Pengembangan dan Pembinaan Bahasa, Kementerian Pendidikan.",
        fungsi: "Menjadi acuan baku dalam penulisan dan pemaknaan kata Bahasa Indonesia.",
        edisiTerbaru: "KBBI Daring (online) – selalu diperbarui di kbbi.kemdikbud.go.id",
        contohEntri: "Bahasa: sistem lambang bunyi yang arbitrer, yang digunakan oleh anggota suatu masyarakat untuk berkomunikasi."
      },
      teksDeskripsi: {
        keywords: ['teks deskripsi', 'deskripsi', 'mendeskripsikan'],
        pengertian: "Teks deskripsi adalah teks yang bertujuan menggambarkan atau melukiskan secara detail suatu objek, tempat, orang, atau suasana agar pembaca seolah melihat langsung.",
        ciri: [
          "Bersifat objektif atau subjektif",
          "Menggunakan kata sifat (adjective)",
          "Menggambarkan ciri fisik, suasana, atau perasaan"
        ],
        struktur: ["Identifikasi objek", "Deskripsi bagian"],
        contoh: "Gunung Bromo tampak megah dengan kepulan asap tipis dari kawahnya. Udara dingin menusuk kulit, namun pemandangan matahari terbit membuat semuanya terasa berharga."
      },
      anekdot: {
        keywords: ['anekdot', 'cerita lucu', 'humor', 'kisah nyata lucu'],
        pengertian: "Anekdot adalah cerita singkat yang lucu atau menarik berdasarkan kejadian nyata, biasanya melibatkan tokoh terkenal atau situasi ironis.",
        ciri: [
          "Berdasarkan kisah nyata",
          "Mengandung unsur humor atau sindiran halus",
          "Singkat dan padat"
        ],
        struktur: ["Orientasi", "Krisis", "Reaksi", "Koda (akhir lucu)"],
        contoh: "Presiden Soekarno pernah ditanya: 'Pak, bagaimana caranya menjadi pintar?' Jawabnya: 'Baca, baca, dan baca!'"
      },
      karyaTulisIlmiah: {
        keywords: ['karya tulis ilmiah', 'kti', 'penelitian', 'makalah', 'skripsi'],
        pengertian: "Karya tulis ilmiah adalah tulisan hasil penelitian atau kajian sistematis yang disusun berdasarkan metode ilmiah untuk menyajikan pemikiran, temuan, atau solusi masalah.",
        jenis: ["Artikel jurnal", "Makalah", "Skripsi", "Tesis", "Disertasi"],
        struktur: [
          "Judul",
          "Abstrak",
          "Pendahuluan",
          "Kajian pustaka",
          "Metodologi",
          "Hasil & pembahasan",
          "Kesimpulan",
          "Daftar pustaka"
        ],
        ciri: ["Objektif", "Logis", "Menggunakan data", "Bahasa formal", "Ada sitasi"]
      },
      olahraga: {
        keywords: ['olahraga', 'cabang olahraga', 'atlet', 'medali', 'kompetisi', 'sehat', 'sejarah olahraga', 'teknik olahraga', 'renang', 'basket', 'voli', 'sepak bola', 'manfaat olahraga'],
        pengertian: "Olahraga adalah aktivitas fisik yang terencana, sistematis, dan bertujuan untuk meningkatkan kebugaran jasmani, keterampilan motorik, kekuatan, daya tahan, koordinasi, serta menanamkan nilai sportivitas, kerja sama, dan disiplin.",
        sejarah: {
          "Dunia": [
            "Olimpiade Kuno di Yunani (776 SM) – diadakan setiap 4 tahun untuk menghormati dewa Zeus, hanya untuk pria Yunani bebas.",
            "Olimpiade Modern pertama di Athena (1896) – diprakarsai oleh Baron Pierre de Coubertin sebagai sarana perdamaian dunia.",
            "FIFA didirikan (1904), FIBA (1932), FINA (1908) untuk mengatur cabang olahraga internasional."
          ],
          "Indonesia": [
            "PON I di Solo (1948) – wujud persatuan bangsa pasca-kemerdekaan.",
            "Indonesia pertama kali ikut Olimpiade di Helsinki (1952).",
            "Indonesia menjadi tuan rumah Asian Games ke-18 (2018) dan sukses meraih peringkat ke-4."
          ]
        },
        jenis: {
          "Berdasarkan Tujuan": ["Prestasi", "Rekreasi", "Pendidikan", "Kesehatan"],
          "Berdasarkan Jumlah Pemain": ["Individu (atletik, renang)", "Beregu (sepak bola, voli, basket)"]
        },
        teknik: {
          "RENANG": {
            "Gaya Bebas (Crawl)": [
              "Gerakan lengan: tarik, dorong, recovery",
              "Gerakan kaki: flutter kick (naik-turun cepat)",
              "Pernapasan: miring ke samping saat lengan keluar air"
            ],
            "Gaya Dada": [
              "Gerakan lengan: tarik ke luar, lalu dorong ke depan",
              "Gerakan kaki: menekuk lutut, lalu tendang keluar-dalam (frog kick)",
              "Pernapasan: angkat kepala saat lengan menarik ke luar"
            ],
            "Gaya Punggung": [
              "Gerakan lengan: seperti gaya bebas, tapi di atas air",
              "Gerakan kaki: flutter kick sambil telentang",
              "Pernapasan: bebas karena wajah selalu di atas air"
            ],
            "Gaya Kupu-kupu": [
              "Gerakan lengan: kedua lengan bersamaan menarik melingkar",
              "Gerakan kaki: dolphin kick (gerakan gelombang dari pinggang)",
              "Pernapasan: angkat kepala saat lengan keluar air"
            ]
          },
          "BASKET": {
            "Dribbling (Menggiring)": "Mengontrol bola dengan satu tangan sambil bergerak; rendah saat dijaga ketat.",
            "Passing (Mengoper)": [
              "Chest pass (operan dada)",
              "Bounce pass (operan pantul)",
              "Overhead pass (operan atas)"
            ],
            "Shooting (Menembak)": [
              "Lay-up: tembakan dekat ring dengan lompatan",
              "Jump shoot: tembakan sambil melompat",
              "Free throw: tembakan hukuman dari garis bebas"
            ],
            "Defense (Bertahan)": "Menjaga lawan dengan posisi rendah, tangan aktif, dan kaki siap bergerak."
          },
          "VOLI": {
            "Servis": [
              "Servis bawah: pukulan dari bawah pinggang (untuk pemula)",
              "Servis atas: pukulan setelah bola dilambungkan (float serve, topspin)"
            ],
            "Passing (Umpan)": "Menggunakan kedua lengan bawah untuk menerima servis atau bola keras.",
            "Setter (Pengumpan)": "Menggunakan jari tangan untuk mengumpan bola ke spiker.",
            "Spike (Smash)": "Pukulan keras ke area lawan setelah melompat.",
            "Block (Blok)": "Membendung serangan lawan di dekat net dengan kedua tangan diangkat."
          },
          "SEPAK BOLA": {
            "Menggiring (Dribbling)": "Mengontrol bola dengan kaki bagian dalam/luar sambil bergerak.",
            "Mengoper (Passing)": [
              "Short pass: umpan pendek akurat",
              "Long pass: umpan jarak jauh",
              "Through pass: umpan tembus antar pemain lawan"
            ],
            "Menembak (Shooting)": [
              "Instep drive: tembakan keras dengan punggung kaki",
              "Chip shot: tembakan melambung di atas kiper",
              "Volley: tembakan sebelum bola menyentuh tanah"
            ],
            "Menghentikan Bola (Stopping)": "Menggunakan telapak kaki, paha, dada, atau kepala untuk mengontrol bola.",
            "Tackling": "Merebut bola dari lawan secara sportif tanpa melanggar."
          }
        },
        manfaat: {
          "Fisik": ["Meningkatkan kardiovaskular", "Memperkuat otot & tulang", "Meningkatkan fleksibilitas", "Mengontrol berat badan"],
          "Mental": ["Mengurangi stres", "Meningkatkan fokus", "Membangun kepercayaan diri"],
          "Sosial": ["Melatih kerja sama", "Menghargai perbedaan", "Menanamkan sportivitas"]
        },
        prestasiIndonesia: {
          "Bulutangkis": [
            "Medali emas Olimpiade: Susi Susanti & Alan Budikusuma (1992), Taufik Hidayat (2004), Greysia/Apriyani (2021)."
          ],
          "Pencak Silat": [
            "14 emas Asian Games 2018 (tuan rumah)."
          ],
          "Lainnya": [
            "Timnas U-16 juara Piala AFF 2022.",
            "Lalu Muhammad Zohri – juara lari 100m Asian Games 2018."
          ]
        }
      },
      sejarah: {
        keywords: [
          'sejarah', 'pengertian sejarah', 'konsep ruang dan waktu sejarah',
          'berpikir kronologis', 'perubahan dan keberlanjutan sejarah',
          'perkembangan bumi', 'makhluk hidup', 'hindu-budha',
          'kerajaan hindu budha', 'masuknya hindu budha',
          'bukti pengaruh hindu budha'
        ],
        pengertianSejarah: "Sejarah adalah ilmu yang mempelajari peristiwa masa lalu yang terjadi pada manusia, disusun secara ilmiah berdasarkan fakta dan interpretasi objektif.",
        peranPentingSejarah: [
          "Menjadi cermin untuk memahami masa kini",
          "Membentuk identitas nasional",
          "Mengembangkan kemampuan berpikir kritis",
          "Menginspirasi generasi mendatang"
        ],
        konsepRuangDanWaktu: {
          pengertian: "Sejarah selalu terjadi pada ruang (lokasi geografis) dan waktu (masa tertentu). Tanpa keduanya, peristiwa tidak bisa dikontekstualisasi.",
          contoh: "Kerajaan Majapahit berada di Jawa Timur (ruang) pada abad ke-13 hingga ke-15 (waktu)."
        },
        berpikirKronologis: {
          pengertian: "Cara berpikir sejarah yang menempatkan peristiwa secara berurutan menurut waktu terjadinya.",
          manfaat: "Membantu memahami sebab-akibat, menelusuri perubahan, dan menghindari penafsiran yang keliru.",
          contoh: "Urutan: Kedatangan Hindu-Budha → Kerajaan Kutai → Kerajaan Tarumanegara → Kerajaan Sriwijaya → Kerajaan Majapahit."
        },
        perubahanDanBerkelanjutan: {
          pengertian: "Sejarah tidak hanya tentang perubahan, tetapi juga hal-hal yang tetap bertahan dari masa ke masa.",
          contohPerubahan: "Sistem pemerintahan dari kerajaan ke republik.",
          contohKontinuitas: "Tradisi upacara adat, nilai gotong royong, sistem irigasi subak di Bali."
        },
        perkembanganBumiDanMakhlukHidup: {
          zamanGeologi: [
            "Arkaikum: bumi terbentuk, belum ada kehidupan",
            "Paleozoikum: muncul kehidupan sederhana (amfibi, ikan)",
            "Mesozoikum: zaman dinosaurus, muncul tumbuhan berbunga",
            "Neozoikum (Kuarter): muncul manusia purba dan peradaban"
          ]
        },
        sejarahHinduBudha: "Periode sejarah Nusantara antara abad ke-1 hingga ke-15 M, ditandai dengan pengaruh peradaban India melalui perdagangan dan penyebaran agama Hindu serta Budha.",
        teoriMasuknyaHinduBudha: {
          "Teori Brahmana": "Dibawa oleh kaum Brahmana yang diundang oleh raja lokal untuk upacara.",
          "Teori Ksatria": "Dibawa oleh prajurit atau bangsawan India yang menaklukkan wilayah Nusantara.",
          "Teori Waisya": "Dibawa oleh pedagang India melalui jalur perdagangan.",
          "Teori Sudra": "Dibawa oleh rakyat jelata India yang ikut dalam kapal perdagangan dan menetap."
        },
        kerajaanHinduBudha: {
          hindu: [
            "Kutai (Kalimantan Timur, abad ke-4)",
            "Tarumanegara (Jawa Barat, abad ke-5)",
            "Mataram Kuno (Jawa Tengah, abad ke-8–10)",
            "Majapahit (Jawa Timur, abad ke-13–15)"
          ],
          budha: [
            "Sriwijaya (Sumatra, abad ke-7–13) – pusat ajaran Budha Mahayana",
            "Singhasari (Jawa Timur, abad ke-13)"
          ]
        },
        akhirKerajaanHinduBudha: "Berkahir sekitar abad ke-15–16 M seiring masuknya agama Islam yang dibawa pedagang Gujarat, Persia, dan Arab, serta kejatuhan Majapahit akibat perang saudara (Perang Paregreg).",
        buktiPengaruhHinduBudhaSaatIni: [
          "Candi Borobudur (Budha) dan Prambanan (Hindu)",
          "Struktur bahasa: kata 'raja', 'negara', 'bumi', 'dewa'",
          "Tradisi: upacara Nyepi, Galungan, upacara adat Jawa",
          "Kesenian: wayang kulit (Mahabharata, Ramayana), tari Kecak",
          "Nama tempat: Surabaya (Sura = ikan hiu, Baya = buaya), Medan (dari kata 'medini' = bumi)"
        ]
      },
      modelMatematika: {
        keywords: ['model matematika', 'pemodelan matematika', 'matematika terapan'],
        pengertian: "Model matematika adalah representasi suatu masalah dunia nyata dalam bentuk persamaan, fungsi, atau sistem persamaan matematika untuk memudahkan analisis dan prediksi.",
        langkah: [
          "Identifikasi variabel dan parameter yang relevan",
          "Menyusun hubungan matematis antar variabel",
          "Menyelesaikan model (analitis atau numerik)",
          "Menginterpretasi hasil dalam konteks masalah asli"
        ],
        contoh: "Misalnya: Sebuah toko menjual pensil (x) dan penghapus (y). Total pendapatan Rp50.000. Jika harga pensil Rp2.000 dan penghapus Rp1.000, maka modelnya: 2000x + 1000y = 50000."
      },
      SPLDV: {
        keywords: ['spldv', 'sistem persamaan linear dua variabel', 'persamaan linear 2 variabel'],
        pengertian: "SPLDV adalah sistem dua persamaan linear dengan dua variabel (misal x dan y) yang memiliki satu, tak hingga, atau tidak ada solusi.",
        bentukUmum: "a₁x + b₁y = c₁\na₂x + b₂y = c₂",
        metodePenyelesaian: ["Metode grafik", "Metode substitusi", "Metode eliminasi", "Metode gabungan"],
        contohPenyelesaian: "2x + y = 7 dan x – y = 2 → dengan substitusi: x=3, y=1.",
        syaratSolusi: {
          "Tepat satu solusi": "Garis berpotongan (koefisien tidak sebanding)",
          "Tak hingga solusi": "Garis berimpit (persamaan ekuivalen)",
          "Tidak ada solusi": "Garis sejajar (koefisien x dan y sebanding, tapi konstanta tidak)"
        }
      },
      SPLTV: {
        keywords: ['spltv', 'sistem persamaan linear tiga variabel', 'persamaan linear 3 variabel'],
        pengertian: "SPLTV adalah sistem tiga persamaan linear dengan tiga variabel (misal x, y, z) yang umumnya memiliki satu solusi unik.",
        bentukUmum: "a₁x + b₁y + c₁z = d₁\na₂x + b₂y + c₂z = d₂\na₃x + b₃y + c₃z = d₃",
        metodePenyelesaian: ["Substitusi bertahap", "Eliminasi bertahap", "Matriks (Cramer, Gauss)"],
        contoh: "x + y + z = 6\n2x – y + z = 3\nx + 2y – z = 2 → solusi: x=1, y=2, z=3."
      },
      SPLSV: {
        keywords: ['splsv', 'sistem persamaan linear satu variabel', 'persamaan linear 1 variabel'],
        pengertian: "SPLSV sebenarnya bukan 'sistem', melainkan persamaan linear satu variabel (PLSV), yaitu persamaan berbentuk ax + b = 0 (a ≠ 0).",
        bentukUmum: "ax + b = 0",
        penyelesaian: "x = –b/a",
        contoh: "3x – 6 = 0 → x = 2.",
        catatan: "Meski disebut 'sistem', secara teknis sistem memerlukan minimal dua persamaan. PLSV diselesaikan secara langsung tanpa metode eliminasi/substitusi."
      },
      persatuanDanKeutuhanUUD1945: {
        keywords: ['persatuan dan keutuhan', 'nkri', 'uud 1945', 'persatuan', 'keutuhan bangsa', 'bhinneka tunggal ika'],
        pengertian: "Persatuan dan keutuhan bangsa menurut UUD NRI 1945 adalah prinsip bahwa wilayah dan bangsa Indonesia bersifat utuh, tidak terpisahkan, dan harus dipertahankan dari segala bentuk ancaman disintegrasi.",
        dasarHukum: [
          "Pembukaan UUD 1945 alinea ke-2: '...membentuk suatu Pemerintah Negara Indonesia yang melindungi segenap bangsa Indonesia dan seluruh tumpah darah Indonesia...'",
          "Pasal 1 ayat (1): 'Negara Indonesia ialah Negara Kesatuan, yang berbentuk Republik.'"
        ],
        nilaiPendukung: [
          "Bhinneka Tunggal Ika",
          "Cinta tanah air",
          "Tolak radikalisme dan separatisme",
          "Utamakan kepentingan nasional di atas kepentingan pribadi atau kelompok"
        ],
        tantangan: ["Konflik SARA", "Gerakan separatis", "Hoaks", "Intervensi asing"]
      },
      masaOrdeLamaSampaiReformasi: {
        keywords: ['orde lama', 'orde baru', 'reformasi', 'soekarno', 'soeharto', 'habibie', 'sejarah indonesia modern'],
        ordeLama: {
          periode: "1945–1966",
          ciriUtama: [
            "Demokrasi Terpimpin",
            "Konfrontasi dengan Malaysia & Belanda",
            "Nasakom (Nasionalisme, Agama, Komunisme)",
            "Krisis ekonomi dan politik"
          ],
          akhir: "Peristiwa G30S/PKI → Soekarno digantikan Soeharto"
        },
        ordeBaru: {
          periode: "1966–1998",
          ciriUtama: [
            "Stabilitas politik & keamanan",
            "Pembangunan ekonomi berbasis swasta & asing",
            "Sentralisasi kekuasaan",
            "Penekanan terhadap kebebasan sipil"
          ],
          akhir: "Krisis moneter 1997–1998 → Jatuhnya Soeharto"
        },
        reformasi: {
          periode: "1998–sekarang",
          ciriUtama: [
            "Demokrasi multipartai",
            "Otonomi daerah",
            "Kebebasan pers",
            "Reformasi birokrasi & penegakan HAM"
          ],
          tokohKunciAwal: ["BJ Habibie", "Abdurrahman Wahid", "Megawati Soekarnoputri"]
        }
      },
      belaBangsaDanBernegara: {
        keywords: ['bela bangsa', 'bela negara', 'cinta tanah air', 'patriotisme', 'wajib bela negara'],
        pengertian: "Bela bangsa dan bernegara adalah sikap dan tindakan warga negara yang dijiwai oleh kecintaan kepada NKRI berdasarkan Pancasila dan UUD 1945 dalam menjamin kelangsungan hidup bangsa dan negara.",
        dasarHukum: "Pasal 27 ayat (3) UUD 1945: 'Setiap warga negara berhak dan wajib ikut serta dalam upaya pembelaan negara.'",
        bentukNyata: [
          "Menjadi TNI/Polri",
          "Menjaga ketertiban di lingkungan",
          "Membayar pajak",
          "Menolak radikalisme",
          "Mengikuti pendidikan kewarganegaraan",
          "Menjaga kebersihan & keamanan lingkungan"
        ],
        semangat: "Rela berkorban demi kepentingan bangsa dan negara."
      },
      teoremaPythagoras: {
        keywords: ['teorema pythagoras', 'rumus pythagoras', 'phytagoras', 'a²+b²=c²'],
        pengertian: "Teorema Pythagoras menyatakan bahwa pada segitiga siku-siku, kuadrat panjang sisi miring (hipotenusa) sama dengan jumlah kuadrat panjang dua sisi lainnya.",
        rumus: "a² + b² = c² (c = sisi miring)",
        contoh: "Jika a = 3, b = 4 → c² = 9 + 16 = 25 → c = 5",
        tripelPythagoras: ["3, 4, 5", "5, 12, 13", "6, 8, 10", "7, 24, 25"],
        penyelesaian: {
          mencariSisiMiring: "Jika diketahui a dan b, maka c = √(a² + b²)",
          mencariSisiSiku: "Jika diketahui c dan a, maka b = √(c² - a²)",
          penerapan: [
            "Menghitung jarak terdekat",
            "Menentukan apakah segitiga siku-siku",
            "Desain arsitektur dan teknik"
          ]
        }
      },
      pedomanNegaraku: {
        keywords: ['pedoman negaraku', 'dasar negara', 'pancasila', 'uud 1945'],
        isi: [
          "Pancasila → dasar falsafah negara",
          "UUD NRI 1945 → konstitusi tertinggi",
          "Bhinneka Tunggal Ika → semboyan persatuan",
          "NKRI → bentuk negara yang final"
        ],
        prinsipHidup: "Bangsa Indonesia hidup berdasarkan hukum, nilai gotong royong, toleransi, dan cinta tanah air."
      },
      prosesPerumusanUUD1945: {
        keywords: ['proses perumusan uud 1945', 'pengesahan uud 1945', 'bpupki', 'ppki'],
        bpupki: "Badan Penyelidik Usaha-usaha Persiapan Kemerdekaan Indonesia (Mei–Juli 1945)",
        sidang1: "29 Mei–1 Juni 1945 → lahirnya dasar negara Pancasila",
        sidang2: "10–17 Juli 1945 → penyusunan UUD",
        ppki: "Panitia Persiapan Kemerdekaan Indonesia → mengesahkan UUD 1945 pada 18 Agustus 1945",
        tokoh: ["Soekarno", "Moh. Yamin", "Soepomo", "Hatta"]
      },
      fungsiDanKedudukanUUD1945: {
        keywords: ['fungsi uud 1945', 'kedudukan uud 1945'],
        fungsi: [
          "Sebagai hukum dasar tertulis",
          "Pedoman penyelenggaraan negara",
          "Sumber segala peraturan perundang-undangan",
          "Pengikat lembaga negara dan warga negara"
        ],
        kedudukan: "UUD NRI 1945 adalah hukum tertinggi di Indonesia. Semua peraturan harus sesuai dengannya."
      },
      beraniMenjalankanUUDLingkungan: {
        keywords: ['berani menjalankan uud di lingkungan', 'uud di tempat tinggal', 'implementasi uud rumah'],
        prinsip: "Menjalankan nilai-nilai UUD 1945 dalam kehidupan sehari-hari di lingkungan tempat tinggal.",
        contoh: [
          "Menegakkan keadilan di lingkungan RT/RW",
          "Tidak membedakan tetangga berdasarkan suku/agama",
          "Menghormati hak orang lain",
          "Patuh pada aturan lingkungan"
        ]
      },
      peraturanDiNegaraku: {
        keywords: ['peraturan di negaraku', 'aturan negara', 'sistem hukum indonesia'],
        hierarki: "Peraturan di Indonesia mengikuti Tata Urutan Perundang-undangan (UU No. 12/2011 jo UU No. 15/2019)."
      },
      peraturanDiRumahku: {
        keywords: ['peraturan di rumahku', 'rumah', 'keluarga', 'aturan keluarga'],
        contoh: [
          "Bangun pagi jam 5",
          "Tidak boleh bermain HP saat makan",
          "Membereskan kamar sendiri",
          "Menghormati orang tua"
        ],
        tujuan: "Membentuk karakter disiplin, tanggung jawab, dan cinta keluarga."
      },
      sekolahkuLingkungankuNegaraku: {
        keywords: ['sekolahku', 'lingkunganku', 'negaraku', 'tanggung jawab warga'],
        sekolah: ["Tepat waktu", "Menghormati guru", "Tidak mencontek"],
        lingkungan: ["Tidak membuang sampah sembarangan", "Gotong royong", "Menjaga ketertiban"],
        negara: ["Membayar pajak", "Mengikuti pemilu", "Menjaga keamanan"]
      },
      tataUrutanPerundangUndangan: {
        keywords: ['tata urutan perundang-undangan', 'hierarki peraturan', 'uu no 12 tahun 2011'],
        pengertian: "Tata urutan perundang-undangan adalah hierarki hukum di Indonesia yang mengatur kedudukan tiap jenis peraturan.",
        urutan: [
          "1. UUD NRI Tahun 1945",
          "2. Ketetapan MPR",
          "3. Undang-Undang / Peraturan Pemerintah Pengganti UU",
          "4. Peraturan Pemerintah",
          "5. Peraturan Presiden",
          "6. Peraturan Daerah (Provinsi → Kabupaten/Kota)"
        ],
        prinsip: "Peraturan di bawah tidak boleh bertentangan dengan peraturan di atas."
      },
      implementasiPeraturan: {
        keywords: ['implementasi peraturan', 'penerapan hukum', 'penegakan hukum'],
        prinsip: [
          "Kepastian hukum",
          "Keadilan substantif",
          "Akuntabilitas",
          "Partisipasi masyarakat"
        ],
        contoh: [
          "Satpol PP menertibkan PKL liar",
          "Pengadilan menghukum koruptor",
          "Warga melapor jika ada pelanggaran"
        ]
      },
      komitmenTataUrutan: {
        keywords: ['komitmen tata urutan', 'komitmen hukum', 'penegakan hierarki hukum'],
        upaya: [
          "Sosialisasi peraturan ke masyarakat",
          "Pelatihan bagi aparat penegak hukum",
          "Revisi produk hukum yang bertentangan",
          "Keterlibatan DPRD dalam penyusunan Perda"
        ],
        tujuan: "Mewujudkan negara hukum yang tertib, adil, dan demokratis."
      },
      persamaanKuadrat: {
        keywords: ['persamaan kuadrat', 'kuadrat', 'ax2+bx+c', 'rumus kuadrat'],
        pengertian: "Persamaan kuadrat adalah persamaan polinomial berderajat dua yang memiliki bentuk umum ax² + bx + c = 0, dengan a ≠ 0.",
        bentukUmum: "ax² + bx + c = 0, di mana a, b, c ∈ bilangan real dan a ≠ 0.",
        contoh: "2x² – 3x + 1 = 0, x² – 4 = 0, –x² + 5x – 6 = 0"
      },
      penyelesaianPersamaanKuadrat: {
        keywords: ['penyelesaian persamaan kuadrat', 'akar-akar kuadrat', 'rumus abc', 'faktorisasi', 'melengkapkan kuadrat'],
        pengertian: "Penyelesaian persamaan kuadrat adalah menentukan nilai x (akar-akar) yang memenuhi persamaan ax² + bx + c = 0.",
        metode: {
          "Faktorisasi": "Misal: x² – 5x + 6 = 0 → (x–2)(x–3)=0 → x=2 atau x=3",
          "Melengkapkan Kuadrat Sempurna": "Ubah bentuk menjadi (x + p)² = q",
          "Rumus ABC (Diskriminan)": "x = [–b ± √(b² – 4ac)] / (2a)",
          "Diskriminan (D)": "D = b² – 4ac → menentukan jenis akar:\n- D > 0: dua akar real berbeda\n- D = 0: akar real sama (kembar)\n- D < 0: akar imajiner (tidak real)"
        },
        contoh: "x² – 4x + 3 = 0 → D = 16 – 12 = 4 → x = (4 ± 2)/2 → x=3 atau x=1"
      },
      masuknyaIslamKeIndonesia: {
        keywords: ['masuknya islam ke indonesia', 'sejarah islam indonesia', 'pedagang muslim', 'kerajaan islam', 'wali songo'],
        pengertian: "Islam masuk ke Indonesia sekitar abad ke-7–13 M, terutama melalui perdagangan laut oleh pedagang Muslim dari Gujarat (India), Persia, dan Arab.",
        teoriMasuknya: {
          "Teori Gujarat": "Islam masuk dari Gujarat, India, dibawa pedagang pada abad ke-13.",
          "Teori Persia": "Budaya Islam Indonesia mirip dengan Persia (misal: peringatan Asyura, nama Wali Songo).",
          "Teori Arab": "Langsung dari Arab melalui jalur perdagangan laut."
        },
        buktiSejarah: [
          "Makam Sultan Malik al-Saleh (1297 M) di Samudera Pasai",
          "Berdirinya kerajaan Islam pertama: Samudera Pasai (abad ke-13)",
          "Kerajaan Demak (abad ke-15–16) sebagai pusat penyebaran Islam di Jawa"
        ],
        tokohPenyebar: "Wali Songo (Sunan Kalijaga, Sunan Giri, dst.), Sultan Malik al-Saleh, Sultan Trenggono",
        dampakBudaya: "Arsitektur masjid (tumpeng, menara), seni wayang, aksara Arab-Jawa (Pegon), tradisi ziarah, dan sistem pendidikan pesantren."
      },
      berpikirKomputasional: {
        keywords: ['berpikir komputasional', 'computational thinking', 'dekomposisi', 'abstraksi', 'pola', 'algoritma', 'pemecahan masalah'],
        pengertian: "Berpikir komputasional adalah proses berpikir sistematis untuk memecahkan masalah kompleks dengan cara yang dapat dipahami dan dieksekusi oleh manusia maupun mesin. Ini bukan tentang coding, melainkan tentang cara berpikir.",
        pilarUtama: {
          dekomposisi: {
            pengertian: "Membagi masalah besar menjadi bagian-bagian kecil yang lebih mudah dikelola.",
            contoh: "Membuat makanan: memisahkan tahap (belanja bahan, memasak, menyajikan)."
          },
          abstraksi: {
            pengertian: "Mengabaikan detail yang tidak penting dan fokus pada informasi yang esensial untuk memecahkan masalah.",
            contoh: "Membuat peta: hanya menampilkan jalan dan lokasi penting, bukan setiap rumah atau pohon."
          },
          pengenalanPola: {
            pengertian: "Mencari kemiripan atau pola dalam masalah atau data untuk menemukan solusi yang dapat digunakan kembali.",
            contoh: "Mengenali pola dalam soal matematika atau pola dalam perilaku pengguna aplikasi."
          },
          algoritma: {
            pengertian: "Merancang langkah-langkah sistematis atau prosedur yang jelas untuk menyelesaikan suatu masalah.",
            contoh: "Resep masakan: langkah demi langkah mulai dari bahan, proses, hingga penyajian."
          }
        },
        manfaat: [
          "Meningkatkan kemampuan pemecahan masalah",
          "Mendorong kreativitas dan inovasi",
          "Melatih logika dan sistematis",
          "Membantu dalam berbagai bidang, bukan hanya teknologi (misal: bisnis, seni, ilmu sosial)"
        ],
        penerapan: [
          "Dalam pendidikan: untuk memecahkan soal matematika, menulis esai, atau melakukan eksperimen sains.",
          "Dalam kehidupan sehari-hari: merencanakan perjalanan, mengatur keuangan, atau menyelesaikan konflik.",
          "Dalam dunia kerja: untuk merancang proses bisnis, menganalisis data, atau mengembangkan produk."
        ],
        hubunganDenganTeknologi: "Berpikir komputasional adalah fondasi untuk belajar ilmu komputer dan teknologi, namun dapat diterapkan di semua bidang tanpa harus menggunakan komputer."
      }
    };

    // === FUNGSI BANTU ===
    function buildKeywordIndex(kb) {
      const index = [];
      for (const key of Object.keys(kb)) {
        const section = kb[key];
        if (section && section.keywords && Array.isArray(section.keywords)) {
          for (const kw of section.keywords) {
            index.push({ keyword: kw.toLowerCase(), key });
          }
        } else {
          index.push({ keyword: key.toLowerCase(), key });
        }
      }
      return index;
    }

    const keywordIndex = buildKeywordIndex(knowledgeBase);

    function formatSection(title, section) {
      if (!section) return `${title}: (tidak ada data)`;
      if (typeof section === 'string') return `${title}:\n${section}`;
      if (Array.isArray(section)) return `${title}:\n- ${section.join('\n- ')}`;
      let out = `${title}:\n`;
      for (const prop of Object.keys(section)) {
        const val = section[prop];
        if (typeof val === 'string') {
          out += `  ${prop}: ${val}\n`;
        } else if (Array.isArray(val)) {
          out += `  ${prop}:\n    - ${val.join('\n    - ')}\n`;
        } else if (typeof val === 'object') {
          out += `  ${prop}:\n`;
          for (const sub of Object.keys(val)) {
            const v = val[sub];
            if (typeof v === 'string') {
              out += `    ${sub}: ${v}\n`;
            } else if (Array.isArray(v)) {
              out += `    ${sub}:\n      - ${v.join('\n      - ')}\n`;
            } else if (typeof v === 'object') {
              out += `    ${sub}:\n`;
              for (const item of Object.keys(v)) {
                const details = v[item];
                if (Array.isArray(details)) {
                  out += `      ${item}:\n        - ${details.join('\n        - ')}\n`;
                } else {
                  out += `      ${item}: ${details}\n`;
                }
              }
            } else {
              out += `    ${sub}: ${String(v)}\n`;
            }
          }
        } else {
          out += `  ${prop}: ${String(val)}\n`;
        }
      }
      return out;
    }

    function searchKnowledge(query) {
      const q = query.toLowerCase().trim();
      if (!q) return "Masukkan pertanyaan atau kata kunci terlebih dahulu.";
      const matches = new Map();
      for (const entry of keywordIndex) {
        if (q.includes(entry.keyword)) {
          matches.set(entry.key, knowledgeBase[entry.key]);
        }
      }
      if (matches.size === 0 && knowledgeBase[q]) {
        matches.set(q, knowledgeBase[q]);
      }
      if (matches.size === 0) {
        const words = q.split(/\s+/);
        for (const w of words) {
          for (const entry of keywordIndex) {
            if (entry.keyword === w) matches.set(entry.key, knowledgeBase[entry.key]);
          }
        }
      }
      if (matches.size === 0) {
        return "Maaf, saya tidak menemukan topik yang cocok. Coba gunakan kata kunci seperti 'pertanian', 'perdagangan dunia', 'teorema pythagoras', 'UUD 1945', 'budaya', 'pancasila', 'olahraga', atau 'sejarah'.";
      }
      let resultText = "";
      for (const [key, section] of matches) {
        resultText += formatSection(key.toUpperCase(), section) + "\n";
      }
      return resultText.trim();
    }

    // === UI ===
    const chatHistory = document.getElementById('chatHistory');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const addImageBtn = document.getElementById('addImageBtn');
    const fileInput = document.getElementById('fileInput');

    function addMessage(text, isUser = false) {
      const div = document.createElement('div');
      div.classList.add('message', isUser ? 'user-message' : 'ai-message');
      div.textContent = text;
      chatHistory.appendChild(div);
      chatHistory.scrollTop = chatHistory.scrollHeight;
    }

    function sendMessage() {
      const msg = userInput.value.trim();
      if (!msg) return;
      addMessage(msg, true);
      userInput.value = '';
      setTimeout(() => {
        const response = searchKnowledge(msg);
        addMessage(response, false);
      }, 500);
    }

    // === FITUR UPLOAD ===
    addImageBtn.addEventListener('click', () => {
      fileInput.click();
    });

    fileInput.addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const fileName = file.name;
      addMessage(`📤 Uploaded: ${fileName}`, true);

      if (file.type === 'text/plain') {
        const text = await file.text();
        addMessage("📄 Menganalisis konten file teks...", false);
        setTimeout(() => {
          const response = searchKnowledge(text);
          addMessage(response, false);
        }, 800);
      } else if (file.type.startsWith('image/')) {
        addMessage("🖼️ Gambar terdeteksi. Silakan ajukan pertanyaan spesifik seperti:\n• 'Apa teknik pertanian pada sawah ini?'\n• 'Apa makna simbol pada baju adat tersebut?'\nSistem akan memberikan analisis berbasis konteks budaya dan pengetahuan lokal.", false);
      } else {
        addMessage("❌ Format file tidak didukung. Harap unggah file teks (.txt) atau gambar (jpg/png).", false);
      }

      fileInput.value = '';
    });

    sendBtn.addEventListener('click', sendMessage);
    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    window.addEventListener('load', () => {
      addMessage("Halo! 😊 Saya Nusantara AI v5.9.\nTanyakan tentang budaya, pertanian, perdagangan dunia, sejarah, UUD 1945, Pancasila, olahraga, atau unggah file teks untuk analisis mendalam!", false);
    });
  </script>
</body>
</html>